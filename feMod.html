
<!DOCTYPE html>
<html>
<head>
    <title>Horizontal Stacked Bar Charts with Shared Interactive Legend and Data Labels</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>

    <!-- Chart.js Data Labels plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>
    <style>
        .chart-container2 {
            width: 700px;
            margin-bottom: 0px;
        }

        #shared-legend2 {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            font-family: Arial, sans-serif;
            user-select: none;
        }

        .legend-item2 {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

            .legend-item.disabled2 {
                opacity: 0.4;
            }

        .legend-color-box2 {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .chart-columns2 {
            display: flex;
            /*gap: 20px;*/ /* spacing between columns */
        }

        .column2 {
            flex: 1; /* each column takes equal width */
            display: flex;
            flex-direction: column;
            /*gap: 20px;*/ /* spacing between charts in column */
        }
    </style>
</head>
<body>
    <div id="shared-legend2"></div>
    <h2 style="text-align:center"><u>Female</u></h2>
    <div class="chart-columns2">
        <!-- Column 1 -->
        <!--20-39-->
        <div class="column2">
            <div class="chart-container2">
                <h3 style="text-align:center">20-39</h3>
               
                <canvas id="Cervix20Chart" height="100"></canvas>
            </div>

            <div class="chart-container2">
                
                <canvas id="Breast20Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
             
                <canvas id="Gb20Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
               
                <canvas id="Lung20Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
                
                <canvas id="Ovary20Chart" height="100"></canvas>
            </div>
           
        </div>


        <!--40-59-->
        <div class="column2">
            <div class="chart-container2">
                <h3 style="text-align:center">40-59</h3>
               
                <canvas id="Cervix40Chart" height="100"></canvas>
            </div>

            <div class="chart-container2">
              
                <canvas id="Breast40Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
                
                <canvas id="Gb40Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
               
                <canvas id="Lung40Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
                
                <canvas id="Ovary40Chart" height="100"></canvas>
            </div>
        </div>



        <!--60+-->
        <div class="colum2">
            <div class="chart-container2">
                <h3 style="text-align:center">60+</h3>
                
                <canvas id="Cervix60Chart" height="100"></canvas>
            </div>

            <div class="chart-container2">
               
                <canvas id="Breast60Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
               
                <canvas id="Gb60Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
                
                <canvas id="Lung60Chart" height="100"></canvas>
            </div>
            <div class="chart-container2">
               
                <canvas id="Ovary60Chart" height="100"></canvas>
            </div>
        </div>
    </div>


    <script>
        // Register the datalabels plugin globally
        Chart.register(ChartDataLabels);

        // Common labels and colors for legend and datasets
        const legendLabels1 = ['Only Sx', 'Only RT', 'Only CT', 'Combination'];
        const legendColors1 = [
            '#1769aa',
                '#b28704',
                '#0cad4e',
                '#ff5722'
        ];

        // Create shared legend dynamically with click handlers
        const legendContainer1 = document.getElementById('shared-legend2');

        // Track visibility state for each dataset (true = visible)
        const visibilityState1 = [true, true, true, true];

        // Create legend items
        legendLabels1.forEach((label, i) => {
            const item = document.createElement('div');
            item.classList.add('legend-item2');
            item.dataset.index = i;

            const colorBox = document.createElement('div');
            colorBox.classList.add('legend-color-box2');
            colorBox.style.backgroundColor = legendColors1[i];

            const text = document.createElement('span');
            text.textContent = label;
            text.style.fontSize = '22px';

            item.appendChild(colorBox);
            item.appendChild(text);
            legendContainer1.appendChild(item);

            // Click event to toggle dataset visibility in both charts
            item.addEventListener('click', () => {
                visibilityState1[i] = !visibilityState1[i];
                updateDatasetVisibility(i, visibilityState1[i]);
                item.classList.toggle('disabled', !visibilityState1[i]);
            });
        });
        // Cervix Chart 20-39
        const Cervix20Ctx = document.getElementById('Cervix20Chart').getContext('2d');

        const Cervix20Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [78.72,77.71,37.14];
                        case 'Only CT': return [0.00,3.01,20.00];
                        case 'Only RT': return [4.26,18.07,40.00,];
                        case 'Only Sx': return [17.02,1.20,2.86];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Cervix20Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: {
                        display: true, text: 'Cervix',
                        color: 'black',      // text color
                        font: {
                            family: 'Arial', // font family
                            size: 16,        // font size
                            weight: 'bold' // optional (bold, normal, etc.)
                        }
                    }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Cervix20Chart = new Chart(Cervix20Ctx, {
            type: 'bar',
            data: Cervix20Data,
            options: Cervix20Options,
            plugins: [ChartDataLabels]
        });


        // Female Breast Chart 20-39
        const Breast20Ctx = document.getElementById('Breast20Chart').getContext('2d');

        const Breast20Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {

                    switch (label) {
                        case 'Combination': return [94.27,95.45,82.95];
                        case 'Only CT': return [2.15,4.05,14.50];
                        case 'Only RT': return [0.36,0.10,2.54];
                        case 'Only Sx': return [3.23,0.40,0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Breast20Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: {
                        display: true, text: 'Breast',
                        color: 'black',      // text color
                        font: {
                            family: 'Arial', // font family
                            size: 16,        // font size
                            weight: 'bold' // optional (bold, normal, etc.)
                        }
                    }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Breast20Chart = new Chart(Breast20Ctx, {
            type: 'bar',
            data: Breast20Data,
            options: Breast20Options,
            plugins: [ChartDataLabels]
        });

        // Gall Bladder Chart 20-39
        const Gb20Ctx = document.getElementById('Gb20Chart').getContext('2d');

        const Gb20Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [30.00, 41.30, 13.04];
                        case 'Only CT': return [30.00, 56.52, 86.96];
                        case 'Only RT': return [0.00, 0.00, 0.00];
                        case 'Only Sx': return [40.00, 2.17, 0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Gb20Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2) : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: {
                        display: true, text: 'Gall Bladder',
                        color: 'black',      // text color
                        font: {
                            family: 'Arial', // font family
                            size: 16,        // font size
                            weight: 'bold' // optional (bold, normal, etc.)
                        }
                    }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Gb20Chart = new Chart(Gb20Ctx, {
            type: 'bar',
            data: Gb20Data,
            options: Gb20Options,
            plugins: [ChartDataLabels]
        });

        //Lung 20-39
        const Lung20Ctx = document.getElementById('Lung20Chart').getContext('2d');

        const Lung20Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [25.00, 45.45, 43.70];
                        case 'Only CT': return [6.25, 24.24, 50.42];
                        case 'Only RT': return [0.00, 0.00, 5.88];
                        case 'Only Sx': return [68.75, 30.30, 0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Lung20Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2) : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: {
                        display: true, text: 'Lung',
                        color: 'black',      // text color
                        font: {
                            family: 'Arial', // font family
                            size: 16,        // font size
                            weight: 'bold' // optional (bold, normal, etc.)
                        }
                    }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Lung20Chart = new Chart(Lung20Ctx, {
            type: 'bar',
            data: Lung20Data,
            options: Lung20Options,
            plugins: [ChartDataLabels]
        });

        //Ovary 20-39
        const Ovary20Ctx = document.getElementById('Ovary20Chart').getContext('2d');

        const Ovary20Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [69.39, 85.29, 82.35];
                        case 'Only CT': return [0.00, 10.29, 15.03];
                        case 'Only RT': return [0.00, 0.00, 0.00];
                        case 'Only Sx': return [30.61, 4.41, 2.61];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Ovary20Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: {
                        display: true, text: 'Ovary',
                        color: 'black',      // text color
                        font: {
                            family: 'Arial', // font family
                            size: 16,        // font size
                            weight: 'bold' // optional (bold, normal, etc.)
                        }
                    }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Ovary20Chart = new Chart(Ovary20Ctx, {
            type: 'bar',
            data: Ovary20Data,
            options: Ovary20Options,
            plugins: [ChartDataLabels]
        });

        //40-59
        // Cervix Chart 40-59
        const Cervix40Ctx = document.getElementById('Cervix40Chart').getContext('2d');

        const Cervix40Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [78.09, 82.11, 38.27];
                        case 'Only CT': return [1.20, 1.73, 20.99];
                        case 'Only RT': return [5.98, 15.51, 40.74];
                        case 'Only Sx': return [14.74, 0.65, 0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Cervix40Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2) : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Cervix40Chart = new Chart(Cervix40Ctx, {
            type: 'bar',
            data: Cervix40Data,
            options: Cervix40Options,
            plugins: [ChartDataLabels]
        });


        // Female Breast Chart 40-59
        const Breast40Ctx = document.getElementById('Breast40Chart').getContext('2d');

        const Breast40Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [95.15, 95.64, 81.89];
                        case 'Only CT': return [2.08, 3.22, 15.95];
                        case 'Only RT': return [0.17, 0.13, 2.08];
                        case 'Only Sx': return [2.60, 1.01, 0.08];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Breast40Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Breast40Chart = new Chart(Breast40Ctx, {
            type: 'bar',
            data: Breast40Data,
            options: Breast40Options,
            plugins: [ChartDataLabels]
        });

        // Gall Bladder Chart 40-59
        const Gb40Ctx = document.getElementById('Gb40Chart').getContext('2d');

        const Gb40Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [55.56, 35.15, 9.21];
                        case 'Only CT': return [11.11, 58.91, 89.08];
                        case 'Only RT': return [0.00, 0.50, 1.50];
                        case 'Only Sx': return [33.33, 5.45, 0.21];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Gb40Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Gb40Chart = new Chart(Gb40Ctx, {
            type: 'bar',
            data: Gb40Data,
            options: Gb40Options,
            plugins: [ChartDataLabels]
        });

        //Lung 40-59
        const Lung40Ctx = document.getElementById('Lung40Chart').getContext('2d');

        const Lung40Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [14.29, 56.72, 51.08];
                        case 'Only CT': return [4.76, 34.33, 40.86];
                        case 'Only RT': return [9.52, 0.75, 7.34];
                        case 'Only Sx': return [71.43, 8.21, 0.72];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Lung40Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Lung40Chart = new Chart(Lung40Ctx, {
            type: 'bar',
            data: Lung40Data,
            options: Lung40Options,
            plugins: [ChartDataLabels]
        });

        //Ovary 40-59
        const Ovary40Ctx = document.getElementById('Ovary40Chart').getContext('2d');

        const Ovary40Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [63.95, 81.78, 78.62];
                        case 'Only CT': return [11.63, 14.57, 20.52];
                        case 'Only RT': return [0.00, 0.00, 0.25];
                        case 'Only Sx': return [24.42, 3.64, 0.61];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Ovary40Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Ovary40Chart = new Chart(Ovary40Ctx, {
            type: 'bar',
            data: Ovary40Data,
            options: Ovary40Options,
            plugins: [ChartDataLabels]
        });

        //60+
        const Cervix60Ctx = document.getElementById('Cervix60Chart').getContext('2d');

        const Cervix60Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [70.97, 58.32, 24.17];
                        case 'Only CT': return [0.00, 2.02, 12.50];
                        case 'Only RT': return [23.66, 39.66, 63.33];
                        case 'Only Sx': return [5.38, 0.00, 0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Cervix60Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Cervix60Chart = new Chart(Cervix60Ctx, {
            type: 'bar',
            data: Cervix60Data,
            options: Cervix60Options,
            plugins: [ChartDataLabels]
        });


        // Female Breast Chart 40-59
        const Breast60Ctx = document.getElementById('Breast60Chart').getContext('2d');

        const Breast60Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [91.91, 93.13, 86.38];
                        case 'Only CT': return [1.04, 3.18, 10.09];
                        case 'Only RT': return [0.41, 0.00, 2.58];
                        case 'Only Sx': return [6.64, 3.69, 0.94];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Breast60Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Breast60Chart = new Chart(Breast60Ctx, {
            type: 'bar',
            data: Breast60Data,
            options: Breast60Options,
            plugins: [ChartDataLabels]
        });

        // Gall Bladder Chart 40-59
        const Gb60Ctx = document.getElementById('Gb60Chart').getContext('2d');

        const Gb60Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [36.00, 38.89, 14.81];
                        case 'Only CT': return [16.00, 52.78, 82.22];
                        case 'Only RT': return [0.00, 0.00, 2.96];
                        case 'Only Sx': return [48.00, 8.33, 0.00];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Gb60Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2) : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Gb60Chart = new Chart(Gb60Ctx, {
            type: 'bar',
            data: Gb60Data,
            options: Gb60Options,
            plugins: [ChartDataLabels]
        });

        //Lung 40-59
        const Lung60Ctx = document.getElementById('Lung60Chart').getContext('2d');

        const Lung60Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [48.00, 53.92, 46.81];
                        case 'Only CT': return [4.00, 30.39, 43.87];
                        case 'Only RT': return [8.00, 7.84, 8.58];
                        case 'Only Sx': return [40.00, 7.84, 0.74];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Lung60Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2) : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Lung60Chart = new Chart(Lung60Ctx, {
            type: 'bar',
            data: Lung60Data,
            options: Lung60Options,
            plugins: [ChartDataLabels]
        });

        //Ovary 40-59
        const Ovary60Ctx = document.getElementById('Ovary60Chart').getContext('2d');

        const Ovary60Data = {
            labels: ['Localised', 'Regional', 'Distant Mets'],
            datasets: legendLabels1.map((label, i) => ({
                label: label,
                data: (() => {
                    switch (label) {
                        case 'Combination': return [76.00, 68.92, 64.96];
                        case 'Only CT': return [8.00, 24.32, 33.62];
                        case 'Only RT': return [0.00, 0.00, 0.00];
                        case 'Only Sx': return [16.00, 6.76, 1.42];
                    }
                })(),
                backgroundColor: legendColors1[i]
            }))
        };

        const Ovary60Options = {
            indexAxis: 'y',
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: false },
                tooltip: { mode: 'index', intersect: false },
                datalabels: {
                    color: '#ffffff',
                    anchor: 'center',
                    align: 'center',
                    font: {
                        //  weight: 'bold',
                        size: 14
                    },
                    formatter: function (value, context) {
                        // Show label only if dataset is visible and value > 0
                        if (context.chart.data.datasets[context.datasetIndex].hidden) return '';
                        return value > 0 ? value.toFixed(2)  : '';
                    }
                }
            },
            scales: {
                x: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '' } },
                y: {
                    stacked: true, title: { display: true, text: '' }, ticks: {
                        font: {
                            size: 16  // <-- Increased font size here
                        },
                        color: '#000000'
                    }
                }
            }
        };

        const Ovary60Chart = new Chart(Ovary60Ctx, {
            type: 'bar',
            data: Ovary60Data,
            options: Ovary60Options,
            plugins: [ChartDataLabels]
        });







        function updateDatasetVisibility(datasetIndex, visible) {
            //20-39
            Cervix20Chart.data.datasets[datasetIndex].hidden = !visible;
            Cervix20Chart.update();

            Breast20Chart.data.datasets[datasetIndex].hidden = !visible;
            Breast20Chart.update();

            Gb20Chart.data.datasets[datasetIndex].hidden = !visible;
            Gb20Chart.update();

            Lung20Chart.data.datasets[datasetIndex].hidden = !visible;
            Lung20Chart.update();

            Ovary20Chart.data.datasets[datasetIndex].hidden = !visible;
            Ovary20Chart.update();

            //40-59
            Cervix40Chart.data.datasets[datasetIndex].hidden = !visible;
            Cervix40Chart.update();

            Breast40Chart.data.datasets[datasetIndex].hidden = !visible;
            Breast40Chart.update();

            Gb40Chart.data.datasets[datasetIndex].hidden = !visible;
            Gb40Chart.update();

            Lung40Chart.data.datasets[datasetIndex].hidden = !visible;
            Lung40Chart.update();

            Ovary40Chart.data.datasets[datasetIndex].hidden = !visible;
            Ovary40Chart.update();

            //60+
            Cervix60Chart.data.datasets[datasetIndex].hidden = !visible;
            Cervix60Chart.update();

            Breast60Chart.data.datasets[datasetIndex].hidden = !visible;
            Breast60Chart.update();

            Gb60Chart.data.datasets[datasetIndex].hidden = !visible;
            Gb60Chart.update();

            Lung60Chart.data.datasets[datasetIndex].hidden = !visible;
            Lung60Chart.update();

            Ovary60Chart.data.datasets[datasetIndex].hidden = !visible;
            Ovary60Chart.update();
        }

    </script>

</body>